@model List<TinyHouseProje.Models.TinyHouse>

@{
    ViewBag.Title = "İlanlarım";
}

<h2>Eklediğiniz İlanlar</h2>

@if (Session["RolID"] != null && Session["RolID"].ToString() == "2")
{
    <div class="mb-3">
        @Html.ActionLink("➕ Yeni İlan Ekle", "Ekle", "TinyHouse", null, new { @class = "btn btn-primary" })
    </div>
}

@if (Model.Count == 0)
{
    <p>Henüz hiç ilan eklemediniz.</p>
}
else
{
    <table class="table table-bordered table-striped">
        <tr>
            <th>Başlık</th>
            <th>Konum</th>
            <th>Fiyat (₺)</th>
            <th>Uygunluk</th>
            <th>Durum</th>
            <th>Görsel</th>
            <th>İşlmeler</th>

        </tr>

        @foreach (var ilan in Model)
        {
            <tr>
                <td>@ilan.Baslik</td>
                <td>@ilan.Konum</td>
                <td>@ilan.Fiyat</td>
                <td>
                    @(ilan.UygunlukBaslangic.HasValue ? ilan.UygunlukBaslangic.Value.ToShortDateString() : "-") -
                    @(ilan.UygunlukBitis.HasValue ? ilan.UygunlukBitis.Value.ToShortDateString() : "-")
                </td>
                <td>@(ilan.Durum ? "Aktif" : "Pasif")</td>
                <td>
                    @if (!string.IsNullOrEmpty(ilan.GorselYolu))
                    {
                        <img src="@Url.Content(ilan.GorselYolu)" alt="İlan Görseli" style="width: 120px; height: auto;" />
                    }
                    else
                    {
                        <span class="text-muted">Görsel yok</span>
                    }
                </td>
                <td>
                    @Html.ActionLink("Detay", "Detay", "TinyHouse", new { id = ilan.EvID }, new { @class = "btn btn-info btn-sm me-1" })
                    @Html.ActionLink("Düzenle", "Duzenle", "TinyHouse", new { id = ilan.EvID }, new { @class = "btn btn-warning btn-sm me-1" })

                    @using (Html.BeginForm("Sil", "TinyHouse", new { id = ilan.EvID }, FormMethod.Post, new { onsubmit = "return confirm('Bu ilanı silmek istediğinize emin misiniz?');", @class = "d-inline" }))
                    {
                        <button type="submit" class="btn btn-danger btn-sm">Sil</button>
                    }
                </td>


            </tr>
        }
    </table>
}
